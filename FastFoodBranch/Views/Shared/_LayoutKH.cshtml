@using FastFoodBranch.Models;
@{

    Layout = null;
    var user = (KhachHang)Session["userKH"];
    QuanLyFastFoodEntities1 db = new QuanLyFastFoodEntities1();
    var dscn = db.ChiNhanhs.ToList();
    var checkCN = Session["locationCN"];
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>

    <link rel="Shortcut Icon" href="~/Content/Logo/fast_food.png" type="image/x-icon" />

    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="~/Content/LayoutKH/css/bootstrap.css" />

    <!--owl slider stylesheet -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
    <!-- nice select  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css" integrity="sha512-CruCP+TD3yXzlvvijET8wV5WxxEh5H8P4cmz0RFbKK6FlZ2sYl3AEsKlLPHbniXKSrDdFewhbmBK5skbdsASbQ==" crossorigin="anonymous" />
    <!-- font awesome style -->
    <link href="~/Content/LayoutKH/css/font-awesome.min.css" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <link href="~/Content/LayoutKH/css/style.css" rel="stylesheet" />
    <!-- responsive style -->
    <!--Style này dành riêng cho trang thông tin khách hàng-->
    <link href="~/Content/LayoutKH/DetaileKH/style_ec.css" rel="stylesheet" />
    <link href="~/Content/LayoutKH/DetaileKH/swiper.css" rel="stylesheet" />

</head>
<body class="@ViewBag.setUp1" data-spy="scroll" data-target=".navbar" data-offset="50">
    <!--Phân vùng Header-->
    <div class="hero_area">
        <div class="bg-box">
            <img src="~/Content/LayoutKH/images/wallpaperflare.com_wallpaper.jpg" alt="">
        </div>
        <!-- header section strats -->
        <header class="header_section">
            <div class="container">
                <nav class="navbar navbar-expand-lg custom_nav-container ">
                    <a class="navbar-brand" href="~/KhachHang/TrangChu">
                        <span>
                            FastFood
                        </span>
                    </a>

                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class=""> </span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav  mx-auto ">
                            <li class="nav-item @ViewBag.act1">
                                <a class="nav-link" href="~/KhachHang/TrangChu">Trang chủ <span class="sr-only">(current)</span></a>
                            </li>
                            <li class="nav-item @ViewBag.act2">
                                <a class="nav-link" href="~/KhachHang/DSThucDon">Thực đơn</a>
                            </li>
                            <li class="nav-item @ViewBag.act3">
                                <a class="nav-link" href="~/KhachHang/VeChungToi">Về chúng tôi</a>
                            </li>
                            <li class="nav-item @ViewBag.act4">
                                <a class="nav-link" href="~/KhachHang/DatBan">Đặt bàn</a>
                            </li>
                            @*<li class="nav-item">
                                    <a href="~/KhachHang/GioHang" class=" nav-link1 ">
                                        <i class="fa fa-shopping-cart"></i>
                                        <span class="count" id="cartItemCount">0</span>
                                    </a>
                                </li>*@
                            <!--<li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small"></span>
                                <img class="img-profile rounded-circle" src="~/Content/Avartar/avartar-1.jpg">
                            </a>-->
                            <!-- Dropdown - User Information -->
                            <!--<div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                     aria-labelledby="userDropdown">
                                    <a class="dropdown-item" href="~/Admin/MyInfo">
                                        <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                        Thông tin tài khoản
                                    </a>
                                    <a class="dropdown-item" href="#">
                                        <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                        Cài đặt
                                    </a>
                                    <a class="dropdown-item" href="~/Admin/LichSuHD">
                                        <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                        Lịch sử hoạt động
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                        <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                        Đăng xuất
                                    </a>
                                </div>
                            </li>-->
                        </ul>
                        <div class="user_option">
                            <a href="#" class="user_link" id="ChonCN">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @@fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><style>
                                                                                                                                                                                                                                                                                        svg {
                                                                                                                                                                                                                                                                                            fill: #ffffff
                                                                                                                                                                                                                                                                                        }
                                </style><path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z" /></svg>
                            </a>
                            @{
                                if (user != null)
                                {


                                    <a href="~/KhachHang/ThongTinKH" class="user_link">
                                        <img class="img-profile rounded-circle" src="@user.HinhAnh">
                                    </a>
                                }
                                else
                                {
                                    <a href="~/KhachHang/LRAccount" class="user_link">
                                        <i class="fa fa-user" aria-hidden="true"></i>
                                    </a>
                                }
                            }


                            <a href="~/KhachHang/GioHang" class="user_link1">
                                <i class="fa fa-shopping-cart"></i>
                                <span class="count" id="cartItemCount">0</span>
                            </a>

                            <style>
                            </style>
                            <a href="" class="order_online">
                                Đặt hàng tực tuyến
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </header>
        <!-- end header section -->
        <!-- slider section -->
        <section class="slider_section " @ViewBag.setUp2>
            <div id="customCarousel1" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <div class="container ">
                            <div class="row">
                                <div class="col-md-7 col-lg-6 ">
                                    <div class="detail-box">
                                        <h1>
                                            Fast Food Restaurant
                                        </h1>
                                        <p>
                                            Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                                        </p>
                                        <div class="btn-box">
                                            <a href="" class="btn1">
                                                Đặt món ngay
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item ">
                        <div class="container ">
                            <div class="row">
                                <div class="col-md-7 col-lg-6 ">
                                    <div class="detail-box">
                                        <h1>
                                            Fast Food Restaurant
                                        </h1>
                                        <p>
                                            Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                                        </p>
                                        <div class="btn-box">
                                            <a href="" class="btn1">
                                                Đặt món ngay
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="container ">
                            <div class="row">
                                <div class="col-md-7 col-lg-6 ">
                                    <div class="detail-box">
                                        <h1>
                                            Fast Food Restaurant
                                        </h1>
                                        <p>
                                            Doloremque, itaque aperiam facilis rerum, commodi, temporibus sapiente ad mollitia laborum quam quisquam esse error unde. Tempora ex doloremque, labore, sunt repellat dolore, iste magni quos nihil ducimus libero ipsam.
                                        </p>
                                        <div class="btn-box">
                                            <a href="" class="btn1">
                                                Đặt món ngay
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container">
                    <ol class="carousel-indicators">
                        <li data-target="#customCarousel1" data-slide-to="0" class="active"></li>
                        <li data-target="#customCarousel1" data-slide-to="1"></li>
                        <li data-target="#customCarousel1" data-slide-to="2"></li>
                    </ol>
                </div>
            </div>

        </section>
        <!-- end slider section -->
    </div>
    <!--Phần modal hiển thị chọn chi nhánh-->

    <div class="modal fade" id="myModalLocation" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-mdb-backdrop="true" data-mdb-keyboard="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="f-result location-saved">
                        <div class="f-top">
                            <h4 id="titleLocation">Chọn địa điểm</h4>
                            <p class="link-type">
                                <a href="" title="Chọn địa điểm giao hàng khác">Chọn địa điểm giao hàng khác</a>
                            </p>
                        </div>
                        <div class="stores-list " id="chooseLocation">
                            @{
                                foreach (var item in dscn)
                                {
                                    if (checkCN != null && item.LocationID == (string)checkCN)
                                    {
                                        <div class="item active ">
                                            <a href="" class="btn-edit"><i class="fa fa-flag"></i></a>
                                            <div class="content" style="cursor: pointer;">
                                                <input value="@item.LocationID" hidden />
                                                <p class="store-name">CỬA HÀNG: @item.TenCN</p>
                                                <p>Địa chỉ: @item.DiaChi</p>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="item ">
                                            <a href="" class="btn-edit"><i class="fa fa-flag"></i></a>
                                            <div class="content" style="cursor: pointer;">
                                                <input value="@item.LocationID" hidden />
                                                <p class="store-name">CỬA HÀNG: @item.TenCN</p>
                                                <p>Địa chỉ: @item.DiaChi</p>
                                            </div>
                                        </div>
                                    }

                                }
                            }

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" title="Hủy bỏ" data-dismiss="modal">Hủy bỏ</button>
                    <button type="button" class="btn btn-primary" title="Chọn địa điểm này" id="chonDD">Chọn địa điểm này</button>
                </div>
            </div>
        </div>
    </div>




    @RenderBody()


    <!-- footer section -->
    <footer class="footer_section">
        <div class="container">
            <div class="row">
                <div class="col-md-4 footer-col">
                    <div class="footer_contact">
                        <h4>
                            Thông tin liên hệ
                        </h4>
                        <div class="contact_link_box">
                            <a href="https://maps.app.goo.gl/Uz96zuK8s5s3fRPZA">
                                <i class="fa fa-map-marker" aria-hidden="true"></i>
                                <span>
                                    Vị trí
                                </span>
                            </a>
                            <a href="">
                                <i class="fa fa-phone" aria-hidden="true"></i>
                                <span>
                                    Gọi ngay để đặt chỗ 0908455325
                                </span>
                            </a>
                            <a href="">
                                <i class="fa fa-envelope" aria-hidden="true"></i>
                                <span>
                                    truongtannha2702@gmail.com
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 footer-col">
                    <div class="footer_detail">
                        <a href="" class="footer-logo">
                            FastFood
                        </a>
                        <p>
                            Necessary, making this the first true generator on the Internet. It uses a dictionary of over 200 Latin words, combined with
                        </p>
                        <div class="footer_social">
                            <a href="https://www.facebook.com/nha.truong.3110567/">
                                <i class="fa fa-facebook" aria-hidden="true"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-twitter" aria-hidden="true"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-linkedin" aria-hidden="true"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-instagram" aria-hidden="true"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-pinterest" aria-hidden="true"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 footer-col">
                    <h4>
                        Giờ mở cửa
                    </h4>
                    <p>
                        Mỗi ngày
                    </p>
                    <p>
                        9.00 AM - 10.00 PM
                    </p>
                </div>
            </div>
            <div class="footer-info">
                <p>
                    &copy; <span id="displayYear"></span> All Rights Reserved By
                    <a href="">Nhóm 07 Thương Mại Điện Tử </a><br><br>
                    &copy; <span id="displayYear"></span> Distributed By
                    <a href="" target="_blank">Nhã Trương</a>
                </p>
            </div>
        </div>
    </footer>
    <!-- footer section -->


    <script src="~/Content/LayoutKH/js/jquery-3.4.1.min.js"></script>
    <!-- popper js -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <!-- bootstrap js -->
    <script src="~/Content/LayoutKH/js/bootstrap01.js"></script>
    <!-- owl slider -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
    </script>
    <!-- isotope js -->
    <script src="https://unpkg.com/isotope-layout@3.0.4/dist/isotope.pkgd.min.js"></script>

    <!-- nice select -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"></script>
    <!-- custom js -->
    <script src="~/Content/LayoutKH/js/custom.js"></script>
    <!--Kiểm tra giỏ hàng khi tải trang-->
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '/KhachHang/LaySLCart',
                method: 'POST',
                success: function (data) {
                    $('#cartItemCount').text(data.sl);
                },
                error: function (error) {
                    console.log('Lỗi khi truy cập dữ liệu số lượng giỏ hàng');
                }
            });
            $('#ChonCN').on('click', function () {
                $('#myModalLocation').modal('show');
            });
            $('.item').click(function () {
                // Loại bỏ lớp "active" từ tất cả các mục
                $('.item').removeClass('active');

                // Thêm lớp "active" vào mục được nhấn
                $(this).addClass('active');
            });
            $('#chonDD').click(function () {
                // Tìm mục (item) có lớp "active"
                var activeItem = $('.item.active');

                // Kiểm tra xem có mục (item) active không
                if (activeItem.length > 0) {
                    // Trích xuất thông tin từ mục (item) active
                    var storeName = activeItem.find('.store-name').text();
                    var diaChi = activeItem.find('p:contains("Địa chỉ:")').text();
                    var id = activeItem.find('input').val();
                    // In thông tin ra console hoặc thực hiện các thao tác khác theo nhu cầu của bạn
                    console.log("Tên cửa hàng: " + storeName);
                    console.log("Địa chỉ: " + diaChi);
                    console.log("ID: " + id);

                    //Gọi đến Ajax để lưu thông tin location ID hiện tại
                    $.ajax({
                        url: '/KhachHang/chonChiNhanh',
                        type: 'POST',
                        data: JSON.stringify({ id: id }),
                        contentType: 'application/json',
                        dataType: "json",
                        success: function (response) {
                            if (response.success == true) {
                                // Xử lý danh sách nhân viên ở đây
                                console.log("Đã gửi dữ liệu thành công");
                                $('#myModalLocation').modal('hide');
                                location.reload();
                            } else {
                                console.log('Lấy data không thành công ');
                                console.log('Ma lỗi: ' + response.nd);
                            }
                            // Xử lý phản hồi và gắn giá trị vào select2
                            //var selectValue = data.selectValue; // Thay 'selectValue' bằng tên thuộc tính bạn muốn lấy
                            //$('#EditSelectBox').val(selectValue);
                        },
                        error: function () {
                            alert('Có lỗi xảy ra trong quá trình lấy dữ liệu.');
                        }
                    });
                } else {
                    // Nếu không có mục active, thông báo cho người dùng
                    alert("Vui lòng chọn một cửa hàng trước khi nhấn Chọn địa điểm này.");
                }
            });
        });
    </script>
    @RenderSection("script", false)
</body>
</html>
